# 123FastRename

123云盘文件批量重命名助手，支持多种重命名模式和灵活的文件管理。

## 功能截图

![功能截图](https://pan1.me/upload/attach/202602/14166_AU5KZU4UB9XRNYV.png)
![功能截图](https://pan1.me/upload/attach/202602/14166_9XVDNC558466NEX.png)
![功能截图](https://pan1.me/upload/attach/202602/14166_GNMS7ETDA3WK7YV.png)
![功能截图](https://pan1.me/upload/attach/202602/14166_9YZ5MGK4FNWX9E3.png)
![功能截图](https://pan1.me/upload/attach/202602/14166_3YZYG6AG5B9B64Y.png)



## ✨ 功能特性

### 🔄 智能文件选择
- **全选支持**：支持全选当前文件夹的所有文件
- **部分选择**：支持手动选择特定文件进行重命名
- **取消选择**：全选后可取消特定文件
- **自动隐藏**：未选择文件时自动隐藏重命名按钮
- **面包屑监听**：切换文件夹时自动清空选择

### 🚀 多种重命名模式
- **按序号重命名**：自定义前缀、序号、后缀，自动生成序号
- **追加重命名**：在文件名前后添加前缀或后缀
- **查找替换**：查找并替换文件名中的特定内容
- **正则替换**：使用正则表达式进行高级替换
- **格式替换**：批量修改文件扩展名

### 🎨 用户界面
- **拖拽排序**：支持拖拽调整文件顺序
- **实时预览**：实时显示重命名后的文件名
- **过滤功能**：支持过滤视频文件
- **统计信息**：显示文件数量、总大小、重命名结果
- **响应式设计**：适配不同屏幕尺寸
- **现代化UI**：清晰的弹窗和操作流程

### 🔒 安全与隐私
- **本地运行**：纯前端JavaScript实现，不依赖外部服务器
- **无数据上传**：所有操作在本地完成，不上传任何数据
- **安全存储**：使用Tampermonkey的安全存储机制

### ⚡ 性能优化
- **缓存机制**：缓存文件列表，避免重复API请求
- **防抖处理**：文件选择变化时使用防抖，减少不必要的更新
- **并行处理**：重命名操作支持并行处理
- **状态管理**：防止重复点击和并发请求

## 📦 安装方法

### 1. 安装浏览器扩展

首先需要安装用户脚本管理器扩展：

- **Chrome/Edge**：[Tampermonkey](https://www.tampermonkey.net/)
- **Firefox**：[Greasemonkey](https://addons.mozilla.org/zh-CN/firefox/addon/greasemonkey/) 或 Tampermonkey
- **Safari**：[Tampermonkey for Safari](https://apps.apple.com/app/tampermonkey/id1482490089)

### 2. 安装脚本

1. 下载本项目中的 `123FastRename.js` 文件
2. 在浏览器中打开 Tampermonkey 扩展
3. 点击「添加新脚本」
4. 将 `123FastRename.js` 的内容复制粘贴到编辑器中
5. 点击「文件」→「保存」或使用快捷键 `Ctrl+S` 保存脚本

## 🚀 使用方法

### 1. 选择文件

1. 打开123云盘网站
2. 浏览到要重命名的文件所在的文件夹
3. 勾选要重命名的文件（支持单选、多选、全选）
4. 点击界面中出现的「批量重命名」按钮

### 2. 排序文件

1. 在弹出的排序对话框中查看选中的文件列表
2. 如需调整顺序，可拖拽文件项进行排序
3. 可使用「文件名升序/降序」按钮快速排序
4. 可使用「过滤视频文件」按钮只显示视频文件
5. 点击「下一步」进入重命名配置

### 3. 配置重命名

#### 按序号重命名

1. 在顶部选择「按序号」标签
2. 输入前缀（可选）：如 `视频_`
3. 输入序号（可选）：如 `01`，会自动递增
4. 输入后缀（可选）：如 `_高清`
5. 实时预览右侧的重命名结果
6. 示例：`视频.mp4` → `视频_01_高清.mp4`

#### 追加重命名

1. 在顶部选择「追加」标签
2. 输入前缀（可选）：如 `【合集】`
3. 输入后缀（可选）：如 `.mp4`
4. 实时预览右侧的重命名结果
5. 示例：`视频.mp4` → `【合集】视频.mp4`

#### 查找替换

1. 在顶部选择「查找替换」标签
2. 输入查找内容：如 `old`
3. 输入替换内容：如 `new`
4. 勾选「忽略大小写」（可选）
5. 实时预览右侧的重命名结果
6. 示例：`old_video.mp4` → `new_video.mp4`

#### 正则替换

1. 在顶部选择「正则替换」标签
2. 输入正则表达式：如 `(\d+)`
3. 输入替换内容：如 `第$1集`
4. 实时预览右侧的重命名结果
5. 示例：`123.mp4` → `第123集.mp4`

#### 格式替换

1. 在顶部选择「格式」标签
2. 输入新的扩展名：如 `mkv`
3. 实时预览右侧的重命名结果
4. 示例：`video.mp4` → `video.mkv`

### 4. 执行重命名

1. 确认预览结果无误后，点击「确定」按钮
2. 等待重命名完成
3. 查看底部的统计信息：成功数量、失败数量、跳过数量
4. 成功的文件显示绿色边框，失败的文件显示红色边框
5. 点击「关闭」按钮关闭对话框
6. 页面自动刷新，查看重命名结果

### 5. 其他操作

- **上一步**：返回排序界面，可重新调整文件顺序
- **删除文件**：在排序界面可删除不需要重命名的文件
- **取消**：点击右上角或底部的「取消」按钮关闭对话框

## 🛠️ 技术架构

### 核心模块

1. **PanApiClient**：123云盘API客户端，处理文件信息获取和重命名
2. **TableRowSelector**：表格行选择器，监听文件选择变化
3. **SelectedFilesManager**：选中文件管理器，处理文件列表缓存和更新
4. **UiManager**：UI管理器，负责弹窗创建和事件处理
5. **Modal**：模态框组件，提供统一的对话框界面

### 技术特点

- **ES6+语法**：使用现代JavaScript语法和特性
- **Promise-based异步编程**：使用Promise和async/await处理异步操作
- **模块化设计**：清晰的代码结构和模块划分
- **MutationObserver**：用于监控DOM变化，实现动态元素注入
- **防抖机制**：优化文件选择更新的性能
- **缓存策略**：缓存文件列表，减少API请求

## 🔧 配置选项

### 开发模式

在代码中可以开启开发模式以查看详细日志：

```javascript
const CONSTANTS = {
    // ...
    DEBUG_MODE: true  // 开启开发模式，输出详细日志
};
```

**生产环境建议关闭：**
```javascript
const CONSTANTS = {
    // ...
    DEBUG_MODE: false  // 关闭开发模式，不输出日志
};
```

## 📝 常见问题

### Q: 批量重命名按钮不显示？
A: 请检查以下几点：
- 是否已选择文件（至少选择一个文件）
- 文件类型是否正确（仅支持文件，不支持文件夹）

### Q: 重命名失败怎么办？
A: 请检查以下几点：
- 网络连接是否正常
- 文件名是否包含非法字符
- 目标文件名是否已存在
- 123云盘API是否正常工作

### Q: 如何跳过某些文件？
A: 在排序界面中，点击文件右侧的「×」按钮删除不需要重命名的文件。

### Q: 序号如何递增？
A: 序号会根据文件在列表中的顺序自动递增，从1开始。如果输入 `01`，则从01开始。

### Q: 如何取消重命名？
A: 重命名过程中无法取消，但完成后可以刷新页面恢复原文件名。

## 🔒 隐私声明

- 本脚本仅在本地运行，不会将您的文件信息发送到任何第三方服务器
- 所有API请求均直接发送到123云盘官方服务器
- 认证信息使用Tampermonkey的安全存储机制，不会明文存储

## 📄 许可证

本项目采用 Apache-2.0 许可证。详见 [LICENSE](LICENSE) 文件。

## 📞 反馈与支持

如果您在使用过程中遇到问题，或有任何建议，请通过以下方式反馈：

- 在项目仓库中提交Issue

---

**注意**：本脚本仅用于个人文件管理，请勿用于任何违反相关服务条款的用途

---

*Made with ❤️ by meguoe*
